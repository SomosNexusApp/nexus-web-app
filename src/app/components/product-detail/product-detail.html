<div class="detail-container container" *ngIf="item; else loadingTpl">
  
  <div class="visual-column">
    <div class="main-image-wrapper glass-panel">
      <img [src]="type === 'oferta' ? asOferta.urlOferta : asProducto.imagenPrincipal"
           [alt]="item.titulo" 
           class="main-image">
      
      <div class="badges-overlay">
        <span class="badge-status" *ngIf="type === 'producto'">{{ asProducto.estadoProducto }}</span>
        <span class="badge-hot" *ngIf="type === 'oferta'">üî• Super Precio</span>
      </div>
    </div>
  </div>

  <div class="info-column">
    
    <div class="breadcrumbs">
      <a routerLink="/" class="back-link">‚Üê Volver al inicio</a>
      <span class="separator">/</span>
      <span class="current-cat">{{ type === 'oferta' ? 'Ofertas' : 'Segunda Mano' }}</span>
    </div>

    <h1 class="item-title">{{ item.titulo }}</h1>

    <div class="price-block">
      <div class="price-row">
        <span class="current-price">
          {{ type === 'oferta' ? asOferta.precioOferta : asProducto.precio }}‚Ç¨
        </span>
        
        <span class="original-price" *ngIf="type === 'oferta' && asOferta.precioOriginal > asOferta.precioOferta">
          {{ asOferta.precioOriginal }}‚Ç¨
        </span>
        
        <span class="discount-tag" *ngIf="type === 'oferta' && asOferta.precioOriginal > 0">
          Ahorras {{ (asOferta.precioOriginal - asOferta.precioOferta).toFixed(2) }}‚Ç¨
        </span>
      </div>
    </div>

    <div class="description-box glass-panel">
      <h3>Descripci√≥n</h3>
      <p>{{ item.descripcion }}</p>
    </div>

    <div class="meta-box">
      <div class="seller-info">
        <div class="avatar-placeholder">
          {{ type === 'oferta' ? asOferta.tienda.charAt(0) : asProducto.publicador.user.charAt(0) || 'U' }}
        </div>
        <div class="seller-details">
          <span class="seller-label">{{ type === 'oferta' ? 'Tienda' : 'Vendedor' }}</span>
          <span class="seller-name">
            {{ type === 'oferta' ? asOferta.tienda : asProducto.publicador.user || 'Usuario Nexus' }}
          </span>
        </div>
      </div>
      
      <div class="trust-badge">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="shield-icon"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
        <span>Nexus Protect: Compra Segura</span>
      </div>
    </div>

    <div class="actions-bar">
      <ng-container *ngIf="type === 'oferta'">
        <a [href]="asOferta.urlOferta" target="_blank" class="btn-nexus-primary btn-block">
          Ir al Chollo
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>
        </a>
      </ng-container>

      <ng-container *ngIf="type === 'producto'">
        <button class="btn-nexus-primary btn-block">
          Comprar Ahora
        </button>
        <button class="btn-nexus-glass btn-block">
          Chat con Vendedor
        </button>
      </ng-container>
    </div>

  </div>
</div>

<ng-template #loadingTpl>
  <div class="loading-container">
    <div class="spinner"></div>
    <p>Cargando detalles...</p>
  </div>
</ng-template>